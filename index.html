<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR 6 Sisi dengan Materi</title>

    <!-- FIX MOBILE ZOOM -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.3.2/aframe/build/aframe-ar.js"></script>

    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            touch-action: none; /* extra anti zoom */
        }

        #openMateriBtn {
            position: fixed;
            top: 15px;
            right: 15px;
            background: #ffffffcc;
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid black;
            font-weight: bold;
            z-index: 10000;
        }

        #materiPanel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid black;
            display: none;
            z-index: 10000;
        }

        #closeMateriBtn {
            margin-top: 15px;
            padding: 10px;
            background: #ddd;
            border-radius: 10px;
            width: 100%;
            text-align: center;
        }

        /* Tombol control AR di bawah */
        #controls {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 9999;
        }
        .ctrl-btn {
            padding: 10px 14px;
            background: #ffffffcc;
            border-radius: 10px;
            border: 2px solid black;
            font-size: 14px;
            font-weight: bold;
        }
    </style>
</head>

<body>

<!-- ===================== ANTI ZOOM SCRIPT ===================== -->
<script>
document.addEventListener('touchmove', function(event) {
    if (event.scale !== 1) { event.preventDefault(); }
}, { passive: false });

let lastTouchEnd = 0;
document.addEventListener('touchend', function(event) {
    const now = new Date().getTime();
    if (now - lastTouchEnd <= 300) { event.preventDefault(); }
    lastTouchEnd = now;
}, false);

document.addEventListener('gesturestart', e => e.preventDefault());
document.addEventListener('gesturechange', e => e.preventDefault());
document.addEventListener('gestureend', e => e.preventDefault());
</script>
<!-- ============================================================ -->

<button id="openMateriBtn">Open Materi</button>

<div id="materiPanel">
    <h3>Materi Brahma</h3>
    <p>
        Brahma adalah dewa pencipta dalam agama Hindu. Ia sering digambarkan memiliki empat wajah 
        yang menghadap ke empat penjuru mata angin.
    </p>
    <div id="closeMateriBtn">Tutup</div>
</div>

<!-- ===================== AR SCENE ===================== -->
<a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

    <a-marker type="pattern" url="marker.patt">
        <a-box id="modelBox"
            depth="1" height="1" width="1"
            position="0 0.5 0">

            <!-- sisi depan -->
            <a-plane position="0 0.5 0.501" rotation="0 0 0" width="1" height="1"
                     src="images/Brahmadepan.png"></a-plane>

            <!-- sisi belakang -->
            <a-plane position="0 0.5 -0.501" rotation="0 180 0" width="1" height="1"
                     src="images/Brahmabelakang.png"></a-plane>

            <!-- kiri -->
            <a-plane position="-0.501 0.5 0" rotation="0 90 0" width="1" height="1"
                     src="images/Brahmakiri.png"></a-plane>

            <!-- kanan -->
            <a-plane position="0.501 0.5 0" rotation="0 -90 0" width="1" height="1"
                     src="images/Brahmakanan.png"></a-plane>

            <!-- atas -->
            <a-plane position="0 1.001 0" rotation="-90 0 0" width="1" height="1"
                     src="images/atas.png"></a-plane>

            <!-- bawah -->
            <a-plane position="0 0.001 0" rotation="90 0 0" width="1" height="1"
                     src="images/bawah.png"></a-plane>

        </a-box>
    </a-marker>

    <a-entity camera></a-entity>
</a-scene>
<!-- ===================================================== -->

<!-- ===================== CONTROL BUTTONS ====================== -->
<div id="controls">
    <button class="ctrl-btn" onclick="rotateModel()">Rotate</button>
    <button class="ctrl-btn" onclick="zoomIn()">Zoom +</button>
    <button class="ctrl-btn" onclick="zoomOut()">Zoom -</button>
    <button class="ctrl-btn" onclick="resetModel()">Reset</button>
</div>

<script>
let box = null;

window.onload = () => {
    box = document.querySelector("#modelBox");
};

function rotateModel() {
    let r = box.getAttribute("rotation");
    box.setAttribute("rotation", { x: r.x, y: r.y + 10, z: r.z });
}

function zoomIn() {
    let s = box.getAttribute("scale");
    box.setAttribute("scale", { x: s.x + 0.1, y: s.y + 0.1, z: s.z + 0.1 });
}

function zoomOut() {
    let s = box.getAttribute("scale");
    box.setAttribute("scale", { x: s.x - 0.1, y: s.y - 0.1, z: s.z - 0.1 });
}

function resetModel() {
    box.setAttribute("rotation", { x: 0, y: 0, z: 0 });
    box.setAttribute("scale", { x: 1, y: 1, z: 1 });
}

// Panel Materi
document.getElementById("openMateriBtn").onclick = () => {
    document.getElementById("materiPanel").style.display = "block";
};
document.getElementById("closeMateriBtn").onclick = () => {
    document.getElementById("materiPanel").style.display = "none";
};
</script>

</body>
</html>
