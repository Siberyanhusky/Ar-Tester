<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Scanner - Sejarah Indonesia</title>
    
    <!-- A-Frame & AR.js -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: #000;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }

        #loading-screen.hidden {
            display: none;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Back Button */
        #back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            color: #667eea;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        #back-button:hover {
            transform: translateX(-5px);
            background: white;
        }

        /* Instructions */
        #instructions {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(102, 126, 234, 0.95);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            z-index: 999;
            text-align: center;
            font-size: 13px;
            font-weight: 500;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        /* Marker Status */
        #marker-status {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(16, 185, 129, 0.95);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            z-index: 998;
            display: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        #marker-status.show {
            display: block;
        }

        #marker-status.model-3d {
            background: rgba(139, 92, 246, 0.95);
        }

        #marker-status .badge-3d {
            display: inline-block;
            background: rgba(255, 255, 255, 0.3);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            margin-left: 5px;
        }

        /* Bottom Info Card for AR */
        #ar-info-card {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 30, 46, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 25px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 998;
            display: none;
            max-width: 90%;
            width: 400px;
            text-align: center;
        }

        #ar-info-card.show {
            display: block;
            animation: slideUpCard 0.4s ease;
        }

        @keyframes slideUpCard {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .ar-card-title {
            font-size: 22px;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
        }

        .ar-card-era {
            font-size: 14px;
            color: #a0a0c0;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .ar-card-period {
            font-size: 13px;
            color: #8888aa;
            margin-bottom: 15px;
        }

        .ar-card-button {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
            transition: all 0.3s ease;
            width: 100%;
        }

        .ar-card-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.6);
        }

        .ar-card-button:active {
            transform: translateY(0);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Info Modal */
        #info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 9998;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        #info-modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideUp 0.4s ease;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .modal-title {
            color: #667eea;
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .modal-era {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .modal-body {
            color: #333;
            line-height: 1.8;
            font-size: 15px;
        }

        .modal-body p {
            margin-bottom: 15px;
        }

        .modal-body strong {
            color: #667eea;
        }

        .modal-footer {
            margin-top: 25px;
            text-align: center;
        }

        .btn-close {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 40px;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .btn-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        /* Virtual Tour Button */
        .tour-button {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .tour-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.6);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .modal-content {
                padding: 20px;
                max-height: 80vh;
            }

            .modal-title {
                font-size: 20px;
            }

            .modal-body {
                font-size: 14px;
            }

            #instructions {
                font-size: 12px;
                padding: 10px 20px;
            }

            #ar-info-card {
                width: 90%;
                padding: 18px 20px;
            }

            .ar-card-title {
                font-size: 18px;
            }

            .ar-card-era {
                font-size: 12px;
            }

            .ar-card-period {
                font-size: 11px;
            }
        }

        /* Hide A-Frame UI */
        .a-enter-vr-button,
        .a-orientation-modal {
            display: none !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="spinner"></div>
        <div class="loading-text">Memuat AR Scanner...</div>
        <div class="loading-subtext">Mohon izinkan akses kamera</div>
    </div>

    <!-- Back Button -->
    <a href="index.html" id="back-button">‚Üê Kembali</a>

    <!-- Instructions -->
    <div id="instructions">
        üì∑ Arahkan kamera ke barcode marker (0-9)
    </div>

    <!-- Marker Status -->
    <div id="marker-status">
        ‚úì Marker Terdeteksi: <span id="marker-name">-</span>
    </div>

    <!-- AR Info Card (untuk marker 0-7) -->
    <div id="ar-info-card">
        <div class="ar-card-title" id="ar-card-title">Objek Sejarah</div>
        <div class="ar-card-era" id="ar-card-era">Era</div>
        <div class="ar-card-period" id="ar-card-period">Periode</div>
        <button class="ar-card-button" onclick="openFromARCard()">
            üîç Lihat Model 3D Interaktif
        </button>
    </div>

    <!-- Info Modal (untuk marker 8-9 Virtual Tour) -->
    <div id="info-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Judul Objek</h2>
                <span class="modal-era" id="modal-era">Era</span>
            </div>
            <div class="modal-body" id="modal-body">
                <p>Loading...</p>
            </div>
            <div class="modal-footer">
                <button class="btn-close" onclick="closeModal()">Tutup</button>
                <button class="tour-button" id="tour-button" style="display:none;" onclick="startTour()">
                    üé• Mulai Virtual Tour
                </button>
            </div>
        </div>
    </div>

    <!-- A-Frame AR Scene -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;" 
        vr-mode-ui="enabled: false"
        renderer="logarithmicDepthBuffer: true; precision: medium; antialias: true;">
        
        <!-- Camera with better lighting -->
        <a-entity camera look-controls="enabled: false">
            <a-entity light="type: ambient; intensity: 0.8;"></a-entity>
            <a-entity light="type: directional; intensity: 0.8;" position="1 1 1"></a-entity>
        </a-entity>

        <!-- Marker 0: Prasasti Ciaruteun (2D Image in AR) -->
        <a-marker type="barcode" value="0" id="marker-0">
            <a-image 
                src="assets/images/artifacts/ciaruteun.png" 
                width="0.8" 
                height="1.2" 
                position="0 0.6 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 1: Kapak Genggam (2D Image in AR) -->
        <a-marker type="barcode" value="1" id="marker-1">
            <a-image 
                src="assets/images/artifacts/kapak-genggam.png" 
                width="0.9" 
                height="0.6" 
                position="0 0.4 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 2: Kapak Lonjong (2D Image in AR) -->
        <a-marker type="barcode" value="2" id="marker-2">
            <a-image 
                src="assets/images/artifacts/kapak-lonjong.png" 
                width="0.9" 
                height="0.6" 
                position="0 0.4 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 3: Homo Erectus (2D Image in AR) -->
        <a-marker type="barcode" value="3" id="marker-3">
            <a-image 
                src="assets/images/fossils/homo-erectus.png" 
                width="0.6" 
                height="1.2" 
                position="0 0.6 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 4: Meganthropus (2D Image in AR) -->
        <a-marker type="barcode" value="4" id="marker-4">
            <a-image 
                src="assets/images/fossils/meganthropus.png" 
                width="0.6" 
                height="1.2" 
                position="0 0.6 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 5: Dolmen (2D Image in AR) -->
        <a-marker type="barcode" value="5" id="marker-5">
            <a-image 
                src="assets/images/structures/dolmen.png" 
                width="1.0" 
                height="0.7" 
                position="0 0.5 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 6: Kjokkenmoddinger (2D Image in AR) -->
        <a-marker type="barcode" value="6" id="marker-6">
            <a-image 
                src="assets/images/structures/kjokkenmoddinger.png" 
                width="1.0" 
                height="0.8" 
                position="0 0.5 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 7: Menhir (2D Image in AR) -->
        <a-marker type="barcode" value="7" id="marker-7">
            <a-image 
                src="assets/images/structures/menhir.png" 
                width="0.5" 
                height="1.5" 
                position="0 0.8 0"
                rotation="-90 0 0"
                transparent="true"
                shader="flat">
            </a-image>
        </a-marker>

        <!-- Marker 8: Candi Borobudur (Virtual Tour) -->
        <a-marker type="barcode" value="8" id="marker-8">
            <a-plane 
                position="0 0 0" 
                rotation="-90 0 0" 
                width="1.5" 
                height="1.5" 
                color="#667eea" 
                opacity="0.8">
            </a-plane>
            <a-text 
                value="CANDI\nBOROBUDUR" 
                align="center" 
                width="2" 
                color="#ffffff"
                position="0 0.01 0"
                rotation="-90 0 0">
            </a-text>
        </a-marker>

        <!-- Marker 9: Candi Prambanan (Virtual Tour) -->
        <a-marker type="barcode" value="9" id="marker-9">
            <a-plane 
                position="0 0 0" 
                rotation="-90 0 0" 
                width="1.5" 
                height="1.5" 
                color="#764ba2" 
                opacity="0.8">
            </a-plane>
            <a-text 
                value="CANDI\nPRAMBANAN" 
                align="center" 
                width="2" 
                color="#ffffff"
                position="0 0.01 0"
                rotation="-90 0 0">
            </a-text>
        </a-marker>

    </a-scene>

    <!-- JavaScript -->
    <script>
        // Marker data dengan semua info lengkap
        const markerData = {
            0: {
                name: "Prasasti Ciaruteun",
                type: "artifact",
                is3D: true,
                useARCard: true,
                era: "Kerajaan Tarumanegara",
                periode: "Abad ke-5 Masehi",
                modelPath: "assets/images/artifacts/ciaruteun.glb"
            },
            1: {
                name: "Kapak Genggam",
                type: "artifact",
                is3D: true,
                useARCard: true,
                era: "Zaman Paleolitikum",
                periode: "2 juta - 200 ribu tahun lalu",
                modelPath: "assets/images/artifacts/kapak-genggam.glb"
            },
            2: {
                name: "Kapak Lonjong",
                type: "artifact",
                is3D: true,
                useARCard: true,
                era: "Zaman Neolitikum",
                periode: "3000 - 1500 SM",
                modelPath: "assets/images/artifacts/kapak-lonjong.glb"
            },
            3: {
                name: "Homo Erectus",
                type: "fossil",
                is3D: true,
                useARCard: true,
                era: "Pleistosen Tengah",
                periode: "1,5 juta - 300 ribu tahun lalu",
                modelPath: "assets/images/fossils/homo-erectus.glb"
            },
            4: {
                name: "Meganthropus Paleojavanicus",
                type: "fossil",
                is3D: true,
                useARCard: true,
                era: "Pleistosen Awal",
                periode: "1-2 juta tahun lalu",
                modelPath: "assets/images/fossils/meganthropus.glb"
            },
            5: {
                name: "Dolmen",
                type: "structure",
                is3D: true,
                useARCard: true,
                era: "Zaman Megalitikum",
                periode: "2000 SM - 500 M",
                modelPath: "assets/images/structures/dolmen.glb"
            },
            6: {
                name: "Kjokkenmoddinger",
                type: "structure",
                is3D: true,
                useARCard: true,
                era: "Zaman Mesolitikum",
                periode: "10.000 - 3000 SM",
                modelPath: "assets/images/structures/kjokkenmoddinger.glb"
            },
            7: {
                name: "Menhir",
                type: "structure",
                is3D: true,
                useARCard: true,
                era: "Zaman Megalitikum",
                periode: "2000 SM - 500 M",
                modelPath: "assets/images/structures/menhir.glb"
            },
            8: {
                name: "Candi Borobudur",
                type: "virtual-tour",
                is3D: false,
                useARCard: false,
                era: "Dinasti Syailendra (780-830 M)",
                location: "Magelang, Jawa Tengah",
                description: "Candi Buddha terbesar di dunia yang dibangun pada abad ke-8. Memiliki struktur punden berundak dengan relief yang menggambarkan ajaran Buddha Mahayana.",
                tourUrl: "virtual-tour.html?temple=borobudur"
            },
            9: {
                name: "Candi Prambanan",
                type: "virtual-tour",
                is3D: false,
                useARCard: false,
                era: "Kerajaan Mataram Kuno (856 M)",
                location: "Sleman, Yogyakarta",
                description: "Kompleks candi Hindu terbesar di Indonesia yang dibangun pada abad ke-9. Terdiri dari 240 struktur candi dengan Candi Siwa sebagai candi utama setinggi 47 meter.",
                tourUrl: "virtual-tour.html?temple=prambanan"
            }
        };

        let currentMarkerId = null;
        let currentTourUrl = null;

        // Hide loading screen
        function hideLoading() {
            console.log('Hiding loading screen');
            const loading = document.getElementById('loading-screen');
            if (loading) {
                loading.classList.add('hidden');
            }
        }

        // Show marker status
        function showMarkerStatus(markerName, is3D) {
            const status = document.getElementById('marker-status');
            const nameSpan = document.getElementById('marker-name');
            if (status && nameSpan) {
                if (is3D) {
                    nameSpan.innerHTML = `${markerName} <span class="badge-3d">3D</span>`;
                    status.classList.add('model-3d');
                } else {
                    nameSpan.textContent = markerName;
                    status.classList.remove('model-3d');
                }
                status.classList.add('show');
            }
        }

        // Hide marker status
        function hideMarkerStatus() {
            const status = document.getElementById('marker-status');
            if (status) {
                status.classList.remove('show');
            }
        }

        // Show AR Info Card (untuk marker 0-7)
        function showARCard(data) {
            const card = document.getElementById('ar-info-card');
            if (!card) return;

            document.getElementById('ar-card-title').textContent = data.name;
            document.getElementById('ar-card-era').textContent = data.era;
            document.getElementById('ar-card-period').textContent = data.periode || '';

            card.classList.add('show');
        }

        // Hide AR Info Card
        function hideARCard() {
            const card = document.getElementById('ar-info-card');
            if (card) {
                card.classList.remove('show');
            }
        }

        // Open 3D Viewer from AR Card (dengan pilihan kualitas)
        function openFromARCard() {
            if (currentMarkerId !== null && markerData[currentMarkerId]) {
                showQualityPopup(currentMarkerId);
            }
        }

        // Show info modal (untuk marker 8-9)
        function showInfo(markerId) {
            const data = markerData[markerId];
            if (!data) return;

            document.getElementById('modal-title').textContent = data.name;
            document.getElementById('modal-era').textContent = data.era;
            document.getElementById('modal-body').innerHTML = `<p>${data.description}</p>`;

            // Show Virtual Tour button
            const tourButton = document.getElementById('tour-button');
            if (data.type === 'virtual-tour') {
                tourButton.style.display = 'block';
                currentTourUrl = data.tourUrl;
            } else {
                tourButton.style.display = 'none';
                currentTourUrl = null;
            }

            document.getElementById('info-modal').classList.add('show');
        }

        // Close modal
        function closeModal() {
            document.getElementById('info-modal').classList.remove('show');
        }

        // Start virtual tour
        function startTour() {
            if (currentTourUrl) {
                window.location.href = currentTourUrl;
            }
        }

        // Initialize AR
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');

            const scene = document.querySelector('a-scene');
            
            if (scene) {
                // Hide loading when scene is loaded
                scene.addEventListener('loaded', function() {
                    console.log('A-Frame scene loaded');
                    setTimeout(hideLoading, 500);
                });

                // Alternative: Hide when rendering starts
                scene.addEventListener('renderstart', function() {
                    console.log('A-Frame render started');
                    hideLoading();
                });

                // Setup marker event listeners
                for (let i = 0; i <= 9; i++) {
                    const marker = document.querySelector(`#marker-${i}`);
                    if (marker) {
                        marker.addEventListener('markerFound', function() {
                            console.log(`Marker ${i} found`);
                            currentMarkerId = i;
                            const data = markerData[i];
                            if (data) {
                                showMarkerStatus(data.name, data.is3D);
                                
                                // Marker 0-7: Pakai AR Card
                                if (data.useARCard) {
                                    setTimeout(() => showARCard(data), 500);
                                } 
                                // Marker 8-9: Pakai Modal (Virtual Tour)
                                else {
                                    setTimeout(() => showInfo(i), 1000);
                                }
                            }
                        });

                        marker.addEventListener('markerLost', function() {
                            console.log(`Marker ${i} lost`);
                            hideMarkerStatus();
                            hideARCard();
                            currentMarkerId = null;
                        });
                    }
                }
            }

            // Emergency fallback: Hide loading after 5 seconds
            setTimeout(function() {
                console.log('Emergency: Force hiding loading screen');
                hideLoading();
            }, 5000);
        });

        // Hide loading on window load (backup)
        window.addEventListener('load', function() {
            console.log('Window loaded');
            setTimeout(hideLoading, 2000);
        });

        // === Popup Pilihan Kualitas Model ===
        function showQualityPopup(markerId) {
            const data = markerData[markerId];
            if (!data || !data.modelPath) return;

            // Buat elemen popup overlay
            const popup = document.createElement('div');
            popup.id = 'quality-popup';
            popup.style.position = 'fixed';
            popup.style.top = '0';
            popup.style.left = '0';
            popup.style.width = '100vw';
            popup.style.height = '100vh';
            popup.style.background = 'rgba(0,0,0,0.85)';
            popup.style.display = 'flex';
            popup.style.flexDirection = 'column';
            popup.style.alignItems = 'center';
            popup.style.justifyContent = 'center';
            popup.style.zIndex = '9999';
            popup.style.color = 'white';
            popup.innerHTML = `
                <div style="
                    background: rgba(30,30,46,0.95);
                    padding: 35px 45px;
                    border-radius: 20px;
                    text-align: center;
                    max-width: 90%;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.6);
                    animation: fadeIn 0.3s ease;
                ">
                    <h2 style="margin-bottom: 10px; font-size: 22px;">Model Ditemukan üè∫</h2>
                    <p style="font-size: 16px; margin-bottom: 25px;">
                        ${data.name}<br>
                        Pilih kualitas model 3D yang ingin ditampilkan:
                    </p>
                    <div style="display:flex;gap:20px;justify-content:center;">
                        <button id="btn-low" style="
                            background:#8b5cf6;border:none;color:white;
                            padding:10px 25px;border-radius:10px;font-weight:600;cursor:pointer;">
                            üü¢ Low
                        </button>
                        <button id="btn-high" style="
                            background:#6366f1;border:none;color:white;
                            padding:10px 25px;border-radius:10px;font-weight:600;cursor:pointer;">
                            üíé High
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(popup);

            // Aksi tombol
            const lowModel = data.modelPath.replace('.glb', '-low.glb');
            document.getElementById('btn-low').addEventListener('click', () => {
                const lowModel = data.modelPath.replace('.glb', '-low.glb');
                window.location.href = `3d-viewer.html?model=${encodeURIComponent(lowModel)}&name=${encodeURIComponent(data.name)}&marker=${markerId}&quality=low`;
            });

            document.getElementById('btn-high').addEventListener('click', () => {
                window.location.href = `3d-viewer.html?model=${encodeURIComponent(data.modelPath)}&name=${encodeURIComponent(data.name)}&marker=${markerId}&quality=high`;
            });
        }
    </script>
</body>
</html>
